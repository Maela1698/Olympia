<div class="form-container-pro">
  
  <div class="form-header">
    <h1 class="page-title">{{ isEditMode ? 'Modifier la Boutique' : 'Ouvrir une nouvelle Boutique' }}</h1>
    <p class="page-subtitle">{{ isEditMode ? 'Mettez √† jour les informations de l\'enseigne.' : 'Configurez le local, le g√©rant et les d√©tails de la boutique.' }}</p>
  </div>

  <form (ngSubmit)="onSubmit()" class="pro-card form-wizard">
    
    <div class="form-section">
      <h3 class="section-title">1. Identit√© de l'enseigne</h3>
      
      <div class="form-row-grid">
        <div class="form-group col-span-2">
          <label>Nom de la boutique <span class="required">*</span></label>
          <input type="text" [(ngModel)]="formData.nom" name="nom" required class="form-control" placeholder="ex: Olympia Mode">
        </div>

        <div class="form-group col-span-2">
          <label>Description du concept</label>
          <textarea [(ngModel)]="formData.description" name="desc" class="form-control" rows="3" placeholder="Que propose cette boutique ?"></textarea>
        </div>

        <div class="form-group">
          <label>Logo de la boutique</label>
          <div class="file-upload-wrapper">
            <input type="file" (change)="onFileSelected($event)" accept="image/*" class="file-input">
            <div *ngIf="isEditMode && formData.logo" class="current-logo">
              <img [src]="formData.logo" alt="Logo actuel">
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>Horaires d'ouverture</label>
          <input type="text" [(ngModel)]="formData.horaires" name="horaires" class="form-control" placeholder="ex: Lun-Sam 9h-18h">
        </div>
      </div>
    </div>

    <hr class="section-divider">

    <div class="form-section">
      <h3 class="section-title">2. Configuration commerciale</h3>
      
      <div class="form-row-grid">
        
        <div class="form-group">
          <label>Cat√©gorie <span class="required">*</span></label>
          <select [(ngModel)]="formData.id_categorie" name="cat" required class="form-control custom-select">
            <option value="" disabled selected>Choisir une cat√©gorie...</option>
            <option *ngFor="let c of categories" [value]="c._id">{{ c.nom }}</option>
          </select>
        </div>

        <div class="form-group">
          <label>G√©rant (Compte Commercial) <span class="required">*</span></label>
          <select [(ngModel)]="formData.id_responsable" name="resp" required [disabled]="isEditMode" class="form-control custom-select" [class.disabled-input]="isEditMode">
            <option value="" disabled selected>Assigner √† un utilisateur...</option>
            <option *ngFor="let u of commerciaux" [value]="u._id">{{ u.name }} ({{ u.mail }})</option>
          </select>
          <small *ngIf="isEditMode" class="help-text text-warning">Le g√©rant ne peut pas √™tre modifi√© apr√®s la cr√©ation.</small>
        </div>

        <div class="form-group col-span-2">
          <label>Emplacement (Box physique) <span class="required">*</span></label>
          
          <select *ngIf="!isEditMode" [(ngModel)]="formData.id_box" name="box" required class="form-control custom-select">
            <option value="" disabled selected>Choisir un local libre...</option>
            <option *ngFor="let b of boxesLibres" [value]="b._id">
              {{ b.nom }} ({{ b.surface }} m¬≤ - √âtage {{ b.etage }})
            </option>
          </select>
          
          <div *ngIf="isEditMode" class="locked-box">
            <span class="icon">üîí</span> Emplacement actuel verrouill√©
          </div>

          <div *ngIf="!isEditMode && boxesLibres.length === 0" class="alert-error">
            ‚ö†Ô∏è Aucun box n'est actuellement libre dans le centre commercial.
          </div>
          <small *ngIf="isEditMode" class="help-text">Pour d√©m√©nager la boutique, supprimez-la et recr√©ez-la dans le nouveau Box.</small>
        </div>

      </div>
    </div>

    <div class="form-footer">
      <button type="button" routerLink="/admin/boutiques" class="btn-cancel">Annuler</button>
      <button type="submit" class="btn-submit" [disabled]="!isEditMode && boxesLibres.length === 0">
        {{ isEditMode ? 'Sauvegarder les modifications' : ' Valider l\'ouverture' }}
      </button>
    </div>

  </form>
</div>