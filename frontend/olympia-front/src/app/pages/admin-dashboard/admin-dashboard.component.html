<div class="container">
  
  <div class="top-actions">
    <button routerLink="/admin/categories" class="btn-secondary">Gestion CatÃ©gories</button>
  </div>

  <div class="header-section">
    <h1>ğŸ›ï¸ Gestion ImmobiliÃ¨re (BOX)</h1>
    <button (click)="openCreateBox()" class="btn-create">â• Ajouter un Box</button>
  </div>

  <div *ngIf="showBoxForm" class="form-box-container" style="background: #f9f9f9; padding: 15px; border: 1px solid #ddd; margin-bottom: 20px;">
    <h3>{{ isEditMode ? 'Modifier le Box' : 'Nouveau Box' }}</h3>
    
    <div style="display: flex; gap: 10px; align-items: flex-end;">
        <div>
            <label>Nom (ex: A-01)</label>
            <input type="text" [(ngModel)]="boxForm.nom" class="input-field">
        </div>
        <div>
            <label>Ã‰tage (0=RDC)</label>
            <input type="number" [(ngModel)]="boxForm.etage" class="input-field">
        </div>
        <div>
            <label>Surface (mÂ²)</label>
            <input type="number" [(ngModel)]="boxForm.surface" class="input-field">
        </div>
        
        <button (click)="saveBox()" class="btn-save">ğŸ’¾ Enregistrer</button>
        <button (click)="cancelBox()" class="btn-cancel">Annuler</button>
    </div>
  </div>

  <table border="1" cellpadding="10" style="border-collapse: collapse; width: 100%;">
    <thead>
      <tr style="background: #eee;">
        <th>Nom Box</th>
        <th>Ã‰tage</th>
        <th>Surface</th>
        <th>Ã‰tat</th>
        <th>Actions</th> </tr>
    </thead>
    <tbody>
      <tr *ngFor="let box of boxes">
        <td>{{ box.nom }}</td>
        <td>{{ box.etage === 0 ? 'RDC' : 'Ã‰tage ' + box.etage }}</td>
        <td>{{ box.surface }} mÂ²</td>
        <td>
          <span *ngIf="box.est_loue" style="color: red; font-weight: bold;">ğŸ”´ LOUÃ‰</span>
          <span *ngIf="!box.est_loue" style="color: green; font-weight: bold;">ğŸŸ¢ LIBRE</span>
        </td>
        <td>
            <button (click)="openEditBox(box)" style="cursor:pointer; margin-right: 5px;">âœï¸</button>
            
            <button *ngIf="!box.est_loue" (click)="deleteBox(box._id)" style="cursor:pointer; color:red;">ğŸ—‘ï¸</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<hr class="separator">

<div class="header-section">
    <h2>Gestion des Boutiques</h2>
    <button routerLink="/admin/create-boutique" class="btn-create">+ Ouvrir une Boutique</button>
</div>

<table class="data-table">
    <thead>
        <tr>
            <th>Logo</th>
            <th>Enseigne & Info</th>
            <th>Emplacement</th>
            <th>GÃ©rant</th>
            <th>Mail</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let b of boutiques">
            <td>
                <img [src]="b.logo || 'https://placehold.co/50'" class="mini-logo" style="width: 70px; height: 70px;">
            </td>
            <td>
                <strong>{{ b.nom }}</strong>
                <br>
                <small>{{ b.id_categorie?.nom }}</small> | <small>{{ b.horaires }}</small>
            </td>
            <td>
                <span class="badge-box">{{ b.id_box?.nom }}</span>
                <br>
                <small>Ã‰tage {{ b.id_box?.etage }}</small>
            </td>
            <td>
               
                <br>
                <small>{{ b.id_responsable?.name }}</small>.
                <small>{{ b.id_responsable?.fname }}</small>
            </td>
            <td>
                <br>
                <small>{{ b.id_responsable?.mail }}</small>
            </td>
            <td>
                <a [routerLink]="['/admin/edit-boutique', b._id]" class="btn-action edit" style="text-decoration:none;">âœï¸</a>
                <button (click)="deleteBoutique(b._id)" class="btn-action delete">ğŸ—‘ï¸</button>
            </td>
        </tr>
    </tbody>
</table>

<p *ngIf="boutiques.length === 0" style="text-align: center; color: #666;">Aucune boutique ouverte pour le moment.</p>